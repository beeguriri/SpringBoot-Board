#### ⛏2023.04.16.

###### 1.날짜 칼럼 추가 시 type error 발생

```java
@Column(insertable = false, updatable = false, columnDefinition = "date default CURRENT_TIMESTAMP")
private Date createDate;
```

+ 확인

  + MySQL date type (date , datetime)

  + 
       current_timestamp 같은 경우 시간까지 찍히므로 date로 타입지정해줄 경우 error code 1067 발생

+ 해결
  + LocalDateTime
+ 추가
  + JpaAuditing 기능 이용하여 입력,수정시간 자동 갱신

```java
//추상클래스 엔티티 생성
@Getter
@MappedSuperclass
@EntityListeners(AuditingEntityListener.class)
public abstract class BaseTimeEntity {

    @CreatedDate
    public LocalDateTime createdDate;

    @LastModifiedDate
    private LocalDateTime modifiedDate;
}

// 각 entity에서 추상클래스 extends
// annotation 추가
public class Board extends BaseTimeEntity {
	...

    @CreatedDate
    public LocalDateTime createdDate;

    @LastModifiedDate
    private LocalDateTime modifiedDate;
    
    ...
}
    
// application file에 enable annotation 추가
@EnableJpaAuditing
@SpringBootApplication
public class ModuFormApplication {
	public static void main(String[] args) {
		SpringApplication.run(ModuFormApplication.class, args);
	}
}
```



###### 2.칼럼 default값 지정시 SQL error 발생

```java
@Column(insertable = false, updatable = false, columnDefinition = "number default 0")
```

+ 해결
  + H2 DataBase 사용할때와 문법이 다른 것 같다

``` java
@Column(insertable = false, columnDefinition = "integer default 0")
```

<br>

#### ⛏2023.04.21.
###### 1.thymeleaf 날짜포맷 지정 관련
+ 기존
```java
<td th:text="${#dates.format(board.createDate, 'yyyy-MM-dd')}">
```
+ 해결
  + `#dates` : utility methods for java.util.Date objects
  + `#calendars` : analogous to #dates, but for java.util.Calendar objects:
  + `#temporals` : deal with date/time objects from the JDK8+ java.time API
```java
<td th:text="${#temporals.format(board.createdDate, 'yyyy-MM-dd HH:mm')}">
```

###### 2.thymeleaf input box 관련
+ 기존
  + /getBoard에서 바로 제목, 내용 수정할수 있도록 함
```java
<input name="title" type="text" th:value="${board.title}" />
```
+ 해결
  + "/getBoard"에서 수정버튼 클릭시 updateBoard/seq paramater 넘기기
  + input box 태그속성값 수정
```java
<td><input type="text" th:field="*{updateBoard.title}"></td>
```

<br>

#### ⛏2023.04.22.
###### 1.updateBoard 관련
+ 문제
  + 수정하기 버튼을 누르면 seq == null 로 넘어감
  + textarea의 수정내용 반영 안됨
+ 해결
  + `input box type="hidden"으로 주고 폼값으로 seq값 전송`
  ```java
    <input type="hidden" th:field="*{updateBoard.seq}">
  ```
  + `textarea name속성 지정해줌`
  ```java
  <textarea id="content" name="content" th:text="${updateBoard.content}" rows="7" cols="50">
  ```
+ 추가
  + thymeleaf expression syntax 관련 공부중
  + Selection expressions are just like variable expressions, 
  + except they will be executed on a previously selected object instead of the whole context variables map.
  + https://www.thymeleaf.org/doc/articles/standarddialect5minutes.html
```java
${...} : Variable expressions.
*{...} : Selection expressions.
```

###### 2.insertBoard 관련
+ 문제
  + User Table의 f.k 연결때문에 입력 불가
  + user 페이지 작업 후 insertBoard 작업 하기

###### 3.게시글 paging처리
+ 해결
  + boardRepository의 상속을 crud => jpa로 변경
  + jpa의 paging기능 이용
  + `PageRequest.of()` 로 페이징 할 게시물 목록 수 지정
  + `@RequestParam` 으로 page값 받아오기
  + thymeleaf 속성지정 : `th:href="@{/boardList(page=${pageStat.index})}"`

<br>

#### ⛏2023.04.23.
###### 1.`Security` 사용 관련
+ Note
  + [참고블로그](https://nahwasa.com/entry/%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8-30%EC%9D%B4%EC%83%81-Spring-Security-%EA%B8%B0%EB%B3%B8-%EC%84%B8%ED%8C%85-%EC%8A%A4%ED%94%84%EB%A7%81-%EC%8B%9C%ED%81%90%EB%A6%AC%ED%8B%B0) 
  + localhost:8080/ 접속 시 로그인 요청화면 자동으로 뜸
  + id : user / password : console창에 생성
  + 로그인 성공 시 boardList로 넘어감
  + 로그인 하지않아도 접근할수있는 예외페이지 설정해주기(회원가입)

<br>

#### ⛏2023.04.24.
###### 1.domain `User`를 `Member` 로 다시 작성
+ 문제
  + security 사용하고자 할때 `UserDetailsService`를 상속받아서 사용하는데
  + `org.springframework.security.core.userdetails.User` 와 `User` Entity 충돌(?)
+ 해결
  + security의 User 클래스 사용하기 위하여
  + 기존의 User domain 관련 파일 모두 삭제 후 Member로 재생성

###### 2.`Security` 사용 관련
+ Note
  + db 정보로 로그인 가능
  + 로그아웃 가능
+ 남은 일
  + 비밀번호 암호화(해야하나...)
  + [x] 로그인하면 게시판목록에 사용자 이름 뜨게 하기
  + 사용자 권한 별 기능 제한하기
  + [x] 회원가입 폼 만들기
  + [x] 게시판 새글입력 연동 확인하기

<br>

#### ⛏2023.04.25.
###### 1.새글 입력 시 user 정보 가져오기
+ Note
  + 게시판 새글입력 시 유저 로그인 정보 활용
    + addBoard 메서드에 파라미터로 user 정보 추가
    + userId로 member 정보 검색해서
    + board의 setMember(member) 넣어주기

###### 2. member 테이블의 'role' column default값 반영 안됨
+ 문제
  + board의 조회수 기본값 넣은것과 동일하게 어노테이션 사용했으나
  + @Column(insertable = false, columnDefinition = "varchar(255) default 'User'")
  + 데이터베이스에는 계속 null값이 입력 됨
+ 해결
  + ==> spring.jpa.hibernate.ddl-auto=update..
  + ==> drop table 후 `@Column(columnDefinition = "varchar(255) default 'User'")`
  + 입력 없으면 User, 별도로 Admin 입력 가능

<br>

#### ⛏2023.04.26.
###### 1. user 권한 관련
+ Note
  + [x] 유저 정보 수정 할 수 있는 페이지 
  + [x] 유저는 본인의 글만 수정, 삭제 가능
+ 문제
  + 관리자는 모든 글 삭제 하게 하고싶은데
  + `user.getAuthorities()` 의 값이 당최 뭔지 모르겠다
  + sysout으로 찍어보면 `[ROLE_Admin]`이 나오는데 ...

<br>

#### ⛏2023.04.xx.
###### 1. comment 할거
+ Note
  + [ ] getboard에 comment list
  + [ ] comment 입력, 수정, 삭제 기능 구현
  + [ ] 유저는 본인의 댓글만 수정, 삭제 가능
  + [ ] 관리자는 모든 댓글 삭제 가능

